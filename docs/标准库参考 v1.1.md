# Xu 语言标准库参考 v1.1

本文档详细说明 Xu 语言 v1.1 的内置类型方法与标准库模块。

## 1. 内置类型方法

### 1.1 列表 (List)

| 方法 | 签名 | 说明 |
|---|---|---|
| `add` | `add(item: T)` | 向列表末尾添加元素 |
| `remove` | `remove(index: int) -> T` | 移除并返回指定索引处的元素 |
| `pop` | `pop() -> T` | 移除并返回最后一个元素 |
| `clear` | `clear()` | 清空列表 |
| `contains` | `contains(item: T) -> bool` | 检查列表是否包含指定元素 |
| `reverse` | `reverse()` | 原地反转列表 |
| `join` | `join(sep: string) -> string` | 使用分隔符连接列表元素为字符串 |
| `len` | `len() -> int` | 返回列表长度 (也可使用属性 `.length`) |
| `filter` | `filter(func(T) -> bool) -> [T]` | 返回满足条件的新列表 |
| `map` | `map(func(T) -> U) -> [U]` | 返回映射后的新列表 |

**示例**：
```xu
let list = [1, 2, 3]
list.add(4)
list.join(", ")  // "1, 2, 3, 4"
```

### 1.2 字典 (Dict)

| 方法 | 签名 | 说明 |
|---|---|---|
| `insert` | `insert(key: K, value: V)` | 插入或更新键值对 |
| `get` | `get(key: K) -> Option[V]` | 安全获取值，不存在返回 none |
| `remove` | `remove(key: K) -> V` | 移除并返回指定键的值 |
| `has` | `has(key: K) -> bool` | 检查键是否存在 |
| `contains` | `contains(key: K) -> bool` | 同 `has` |
| `clear` | `clear()` | 清空字典 |
| `merge` | `merge(other: Dict)` | 将另一个字典合并入当前字典 |
| `keys` | `keys() -> [K]` | 返回所有键的列表 |
| `values` | `values() -> [V]` | 返回所有值的列表 |
| `len` | `len() -> int` | 返回键值对数量 (也可使用属性 `.length`) |

**示例**：
```xu
let map = {"a": 1}
map.insert("b", 2)
map.get("a") // Option#some(1)
```

### 1.3 字符串 (String)

| 方法 | 签名 | 说明 |
|---|---|---|
| `format` | `format(args: {string: any}) -> string` | 使用字典替换字符串中的 `{key}` |
| `split` | `split(sep: string) -> [string]` | 按分隔符拆分字符串 |
| `replace` | `replace(from: string, to: string) -> string` | 替换所有匹配的子串 |
| `trim` | `trim() -> string` | 去除首尾空白字符 |
| `to_upper` | `to_upper() -> string` | 转大写 |
| `to_lower` | `to_lower() -> string` | 转小写 |
| `contains` | `contains(sub: string) -> bool` | 是否包含子串 |
| `starts_with` | `starts_with(sub: string) -> bool` | 是否以子串开头 |
| `ends_with` | `ends_with(sub: string) -> bool` | 是否以子串结尾 |
| `to_int` | `to_int() -> int` | 解析为整数 |
| `to_float` | `to_float() -> float` | 解析为浮点数 |
| `len` | `len() -> int` | 返回字符数 (也可使用属性 `.length`) |

**示例**：
```xu
"Hello {name}".format({"name": "World"}) // "Hello World"
"a,b,c".split(",") // ["a", "b", "c"]
```

---

## 2. 标准库模块

使用 `use` 关键字导入模块。

### 2.1 Math (数学)

导入：`use "math"`

| 名称 | 类型 | 说明 |
|---|---|---|
| `pi` | float | 圆周率 (3.14159...) |
| `e` | float | 自然对数底 (2.71828...) |
| `sin(x)` | func | 正弦 (弧度) |
| `cos(x)` | func | 余弦 (弧度) |
| `tan(x)` | func | 正切 (弧度) |
| `sqrt(x)` | func | 平方根 |
| `log(x)` | func | 自然对数 |
| `pow(x, y)` | func | 指数 x^y |
| `random(min, max)` | func | 生成 [min, max] 范围内的随机整数 |

### 2.2 Time (时间)

导入：`use "time"`

| 名称 | 类型 | 说明 |
|---|---|---|
| `unix_time()` | func | 当前 Unix 时间戳 (秒) |
| `unix_millis()` | func | 当前 Unix 时间戳 (毫秒) |
| `mono_micros()` | func | 单调时钟 (微秒) |
| `mono_nanos()` | func | 单调时钟 (纳秒) |

### 2.3 Json (JSON处理)

导入：`use "json"`

| 名称 | 类型 | 说明 |
|---|---|---|
| `parse(s)` | func | 解析 JSON 字符串 |
| `string(v)` | func | 将值序列化为 JSON 字符串 |

> 注意：当前 JSON 实现较为基础，可能不支持复杂嵌套结构的完整序列化。

### 2.4 File (文件操作)

导入：`use "file"` (需确认实现状态)

*注：文件操作通常作为内置对象 `file` 或模块提供，具体 API 待 `stdlib/file.xu` 完善。*

### 2.5 Sys (系统)

导入：`use "sys"`

*注：包含系统级操作，具体 API 待完善。*
